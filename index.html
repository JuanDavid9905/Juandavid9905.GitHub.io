<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Minesweeper - All-in-One</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      margin: 0;
      padding: 20px;
      text-align: center;
    }

    h1 {
      margin-bottom: 10px;
    }

    .controls {
      margin-bottom: 20px;
    }

    .controls button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      cursor: pointer;
    }

    #board {
      display: inline-grid;
      margin-top: 10px;
    }

    .cell {
      width: 30px;
      height: 30px;
      border: 1px solid #ccc;
      background: #e0e0e0;
      font-size: 18px;
      font-weight: bold;
      text-align: center;
      line-height: 30px;
      cursor: pointer;
      user-select: none;
    }

    .cell.revealed {
      background: #d4d4d4;
      cursor: default;
    }

    .cell.bomb {
      background: red;
      color: white;
    }

    .cell.flagged {
      background: yellow;
    }

    #subscribe {
      position: fixed;
      bottom: 15px;
      right: 15px;
      background-color: #ff0000;
      color: white;
      padding: 10px 15px;
      font-size: 16px;
      border: none;
      border-radius: 4px;
      text-decoration: none;
      font-weight: bold;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
    }

    #subscribe:hover {
      background-color: #cc0000;
    }
  </style>
</head>
<body>
  <h1>Minesweeper</h1>

  <div class="controls">
    <button onclick="startGame(8, 10)">Small (8x8)</button>
    <button onclick="startGame(16, 40)">Medium (16x16)</button>
    <button onclick="startGame(24, 99)">Big (24x24)</button>
  </div>

  <div id="board"></div>

  <a id="subscribe" href="https://www.youtube.com/@juandavid9905-studios?sub_confirmation=1" target="_blank">
    Subscribe
  </a>

  <script>
    const boardElement = document.getElementById('board');
    let board = [];
    let rows = 0;
    let cols = 0;
    let mines = 0;
    let revealedCount = 0;

    function startGame(size, mineCount) {
      rows = cols = size;
      mines = mineCount;
      revealedCount = 0;
      board = [];
      boardElement.innerHTML = '';
      boardElement.style.gridTemplateColumns = `repeat(${cols}, 30px)`;
      boardElement.style.gridTemplateRows = `repeat(${rows}, 30px)`;

      // Initialize board
      for (let r = 0; r < rows; r++) {
        board[r] = [];
        for (let c = 0; c < cols; c++) {
          const cell = {
            row: r,
            col: c,
            isRevealed: false,
            isMine: false,
            isFlagged: false,
            neighborMines: 0,
            element: document.createElement('div')
          };

          cell.element.classList.add('cell');
          cell.element.addEventListener('click', () => handleLeftClick(cell));
          cell.element.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            toggleFlag(cell);
          });

          boardElement.appendChild(cell.element);
          board[r][c] = cell;
        }
      }

      // Place mines
      let placed = 0;
      while (placed < mines) {
        let r = Math.floor(Math.random() * rows);
        let c = Math.floor(Math.random() * cols);
        if (!board[r][c].isMine) {
          board[r][c].isMine = true;
          placed++;
        }
      }

      // Calculate neighbor counts
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          if (!board[r][c].isMine) {
            board[r][c].neighborMines = countNeighbors(r, c);
          }
        }
      }
    }

    function countNeighbors(r, c) {
      let count = 0;
      for (let dr = -1; dr <= 1; dr++) {
        for (let dc = -1; dc <= 1; dc++) {
          let nr = r + dr;
          let nc = c + dc;
          if (nr >= 0 && nr < rows && nc >= 0 && nc < cols && board[nr][nc].isMine) {
            count++;
          }
        }
      }
      return count;
    }

    function handleLeftClick(cell) {
      if (cell.isRevealed || cell.isFlagged) return;
      cell.isRevealed = true;
      cell.element.classList.add('revealed');

      if (cell.isMine) {
        cell.element.classList.add('bomb');
        cell.element.textContent = 'ðŸ’£';
        revealAll();
        alert("Game Over!");
        return;
      }

      revealedCount++;
      if (cell.neighborMines > 0) {
        cell.element.textContent = cell.neighborMines;
      } else {
        revealEmptyNeighbors(cell.row, cell.col);
      }

      if (revealedCount === rows * cols - mines) {
        alert("You Win!");
        revealAll(true);
      }
    }

    function toggleFlag(cell) {
      if (cell.isRevealed) return;
      cell.isFlagged = !cell.isFlagged;
      cell.element.classList.toggle('flagged');
      cell.element.textContent = cell.isFlagged ? 'ðŸš©' : '';
    }

    function revealEmptyNeighbors(r, c) {
      for (let dr = -1; dr <= 1; dr++) {
        for (let dc = -1; dc <= 1; dc++) {
          let nr = r + dr;
          let nc = c + dc;
          if (nr >= 0 && nr < rows && nc >= 0 && nc < cols) {
            let neighbor = board[nr][nc];
            if (!neighbor.isRevealed && !neighbor.isMine && !neighbor.isFlagged) {
              neighbor.isRevealed = true;
              neighbor.element.classList.add('revealed');
              revealedCount++;
              if (neighbor.neighborMines > 0) {
                neighbor.element.textContent = neighbor.neighborMines;
              } else {
                revealEmptyNeighbors(nr, nc);
              }
            }
          }
        }
      }
    }

    function revealAll(win = false) {
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          const cell = board[r][c];
          if (cell.isMine) {
            cell.element.classList.add('revealed');
            cell.element.textContent = 'ðŸ’£';
          } else if (!cell.isRevealed && win) {
            cell.element.classList.add('revealed');
            if (cell.neighborMines > 0) {
              cell.element.textContent = cell.neighborMines;
            }
          }
        }
      }
    }

    // Start with small by default
    startGame(8, 10);
  </script>
</body>
</html>
